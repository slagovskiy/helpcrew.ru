{% extends 'base.html' %}

{% block content %}
        {% if not crew %}
        <div class="form-top col-md-12"></div>
        <div class="col-md-2"></div>
        <div class="col-md-8">
            <h2>Новая команда</h2>
            <form action="{% url 'crew_edit' %}" method="post" id="form-crewedit" enctype="multipart/form-data">
                {% csrf_token %}
                <input type="hidden" name="slug" value="{{ form.name }}">
                <div class="col-md-12">
                    <div class="col-md-3 form-label">
                        Имя новой команды*
                    </div>
                    <div class="col-md-9">
                        <input type="text" class="form-control" id="name" name="name" placeholder="Имя" value=""
                               data-validation="length" data-validation-length="2-100"
                               data-validation-error-msg="Введите имя команды"
                        />
                    </div>
                </div>
                <div class="col-md-12">
                    <div class="col-md-3 form-label">
                        Адрес команды
                    </div>
                    <div class="col-md-9">
                        <input type="text" class="form-control" id="url" name="url" placeholder="Адрес" value=""
                               data-validation="server" data-validation-url="{% url 'crew_check_url' %}"
                               data-validation-optional="true"
                               data-validation-error-msg="Введите адрес команды, используя латинские символы и цифры"
                        />
                    </div>
                    <div class="col-md-3">
                    </div>
                    <div class="col-md-9 form-comment">
                        Для быстрого перехода на страницу команды http://helpcrew.ru/p/<span style="color: red">my_crew</span>
                    </div>
                </div>
                <div class="col-md-12">
                    <input type="submit" class="form-control btn btn-primary" value="сохранить" />
                </div>
            </form>
        </div>
        <div class="col-md-2"></div>
        <div class="form-bottom col-md-12"></div>
        {% else %}
            <div class="col-md-12">
                <h2>Команда &laquo{{ crew.name }}&raquo;</h2>
            </div>
            <div class="col-md-6">
                <h2>Свойства команды</h2>
                <form action="{% url 'crew_edit' %}" method="post" id="form-crewedit" enctype="multipart/form-data">
                    {% csrf_token %}
                    <input type="hidden" name="slug" value="{{ crew.slug }}">
                    <div class="col-md-12">
                        <div class="col-md-3 form-label">
                            Имя команды*
                        </div>
                        <div class="col-md-9">
                            <input type="text" class="form-control" id="name" name="name" placeholder="Имя" value="{{ crew.name }}"
                                   data-validation="length" data-validation-length="2-100"
                                   data-validation-error-msg="Введите имя команды"
                            />
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="col-md-3 form-label">
                            Адрес команды
                        </div>
                        <div class="col-md-9">
                            <input type="text" class="form-control" id="url" name="url" placeholder="Адрес" value="{{ crew.url }}"
                                   data-validation="server" data-validation-url="{% url 'crew_check_url' %}"
                                   data-validation-optional="true"
                                   data-validation-error-msg="Введите адрес команды, используя латинские символы и цифры"
                            />
                        </div>
                        <div class="col-md-3">
                        </div>
                        <div class="col-md-9 form-comment">
                            Для быстрого перехода на страницу команды http://helpcrew.ru/p/<span style="color: red">my_crew</span>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <input type="submit" class="form-control btn btn-primary" value="сохранить" />
                    </div>
                </form>
            </div>
            <div class="col-md-6 crew-edit">
                <h2>Члены команды</h2>
                {% for cu in crew.crewusers_set.all %}
                <div class="crew-user-list">
                    {% ifequal cu.type 0 %}<i class="fa fa-user color-b" aria-hidden="true" title="Администратор"></i> {% endifequal %}
                    {% ifequal cu.type 1 %}<i class="fa fa-user color-o" aria-hidden="true" title="Диспетчер"></i> {% endifequal %}
                    {% ifequal cu.type 2 %}<i class="fa fa-user color-y" aria-hidden="true" title="Оператор"></i> {% endifequal %}
                    {{ cu.user.name }}
                    <div class="btn-group" role="group">
                        <a href="#" class="btn btn-link btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu">
                            <li><a href="{% url 'crew_edit_user_edit' crew.url cu.user.email 'a' %}">
                                {% ifequal cu.type 0 %}
                                    <i class="fa fa-check-square-o" aria-hidden="true"></i>
                                {% else %}
                                    <i class="fa fa-square-o" aria-hidden="true"></i>
                                {% endifequal %}
                                Администратор</a></li>
                            <li><a href="{% url 'crew_edit_user_edit' crew.url cu.user.email 'd' %}">
                                {% ifequal cu.type 1 %}
                                    <i class="fa fa-check-square-o" aria-hidden="true"></i>
                                {% else %}
                                    <i class="fa fa-square-o" aria-hidden="true"></i>
                                {% endifequal %}
                                Диспетчер</a></li>
                            <li><a href="{% url 'crew_edit_user_edit' crew.url cu.user.email 'o' %}">
                                {% ifequal cu.type 2 %}
                                    <i class="fa fa-check-square-o" aria-hidden="true"></i>
                                {% else %}
                                    <i class="fa fa-square-o" aria-hidden="true"></i>
                                {% endifequal %}
                                Оператор</a></li>
                            <li role="separator" class="divider"></li>
                            <li><a href="#">Удалить</a></li>
                        </ul>
                    </div>

                </div>
                {% endfor %}
                <div class="col-md-12">
                    <input type="submit" class="form-control btn btn-primary" value="пригласить нового участника" />
                </div>
            </div>
        {% endif %}
{% endblock %}